<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Semicontinuous • assessor</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Semicontinuous">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">assessor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/assessor.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/2pm.html">Two part</a></li>
    <li><a class="dropdown-item" href="../articles/disc.html">Discrete</a></li>
    <li><a class="dropdown-item" href="../articles/ord.html">Ordered curve</a></li>
    <li><a class="dropdown-item" href="../articles/quasi.html">Quasi Emprical residuals functions</a></li>
    <li><a class="dropdown-item" href="../articles/semiconti.html">Semicontinuous</a></li>
    <li><a class="dropdown-item" href="../articles/zeroinfl.html">Zero-inflated discrete</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jhlee1408/assessor/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Semicontinuous</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhlee1408/assessor/blob/master/vignettes/articles/semiconti.Rmd" class="external-link"><code>vignettes/articles/semiconti.Rmd</code></a></small>
      <div class="d-none name"><code>semiconti.Rmd</code></div>
    </div>

    
    
<div class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills" id="semicontinuous-outcome-regression-models">Semicontinuous outcome regression
models<a class="anchor" aria-label="anchor" href="#semicontinuous-outcome-regression-models"></a>
</h3>
<p><code><a href="../reference/resid_semiconti.html">resid_semiconti()</a></code> is used for calculating the DPIT
residuals for regression models with semicontinuous outcomes and
constructing corresponding QQ-plots. Specifically, a Tobit regression
and a Tweedie regression model are suitable models for
<code><a href="../reference/resid_semiconti.html">resid_semiconti()</a></code>. The suitable model objects are as
follows:</p>
<ul>
<li>Tweedie, <code>glm(family= tweedie())</code>
</li>
<li>Tobit(VGAM), <code><a href="https://rdrr.io/pkg/VGAM/man/vglm.html" class="external-link">VGAM::vglm()</a></code>
</li>
<li>Tobit(AER), <code><a href="https://rdrr.io/pkg/AER/man/tobit.html" class="external-link">AER::tobit()</a></code>
</li>
</ul>
<ul class="nav nav-pills" id="semicontinuous-outcome-regression-models" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tweedie" id="tweedie-tab" type="button" role="tab" aria-controls="tweedie" aria-selected="true" class="active nav-link">Tweedie</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#tobit" id="tobit-tab" type="button" role="tab" aria-controls="tobit" aria-selected="false" class="nav-link">Tobit</button></li>
</ul>
<div class="tab-content">
<div class="active  tab-pane" id="tweedie" role="tabpanel" aria-labelledby="tweedie-tab">

<p>We simulate <code>y1</code> to follow Tweedie distribution depending
on covariates <code>x11</code> and <code>x12</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Tweedie model</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhlee1408.github.io/assessor/">assessor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tweedie</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">statmod</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">x11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">x12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">beta2</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">lambda1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">beta0</span> <span class="op">+</span> <span class="va">beta1</span> <span class="op">*</span> <span class="va">x11</span> <span class="op">+</span> <span class="va">beta2</span> <span class="op">*</span> <span class="va">x12</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tweedie/man/dtweedie.html" class="external-link">rtweedie</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="va">lambda1</span>, xi <span class="op">=</span> <span class="fl">1.6</span>, phi <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>In constructing <code>model2</code>, the intentional omission of the
covariate <code>x12</code> was aimed at facilitating a direct comparison
with the true model, <code>model1</code>. As expected, the QQ plot in
the right panel corresponding to <code>model2</code> exhibits a
substantial deviation from the diagonal line, attributing this deviation
to the deliberate omission. Conversely, the left panel shows a closer
alignment along the diagonal, implying a better fit when including both
covariates, <code>x11</code> and <code>x12</code>. This outcome strongly
suggests that incorporating all covariates results in a more appropriate
and improved model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># True model</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">x11</span> <span class="op">+</span> <span class="va">x12</span>,</span>
<span>    family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></span><span class="op">(</span>var.power <span class="op">=</span> <span class="fl">1.6</span>, link.power <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># missing covariate</span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">x11</span> ,</span>
<span>    family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/statmod/man/tweedie.html" class="external-link">tweedie</a></span><span class="op">(</span>var.power <span class="op">=</span> <span class="fl">1.6</span>, link.power <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">resid1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resid_semiconti.html">resid_semiconti</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span>
<span><span class="va">resid2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resid_semiconti.html">resid_semiconti</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span></span></code></pre></div>
<p><img src="semiconti_files/figure-html/tweedie2-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="tab-pane" id="tobit" role="tabpanel" aria-labelledby="tobit-tab">

<p><code><a href="../reference/resid_semiconti.html">resid_semiconti()</a></code> function supports calculating DPIT
residuals for a Tobit regression from both <code><a href="https://rdrr.io/pkg/VGAM/man/vglm.html" class="external-link">VGAM::vglm</a></code> and
<code><a href="https://rdrr.io/pkg/AER/man/tobit.html" class="external-link">AER::tobit</a></code> packages.</p>
<p>In this example, we assume that the latent variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mo>*</mo></msup><annotation encoding="application/x-tex">Y^*</annotation></semantics></math>
follows a normal distribution with a mean given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">\mu=\beta_0+\beta_1X_1+\beta_2X_2, </annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo>∼</mo><mi>U</mi><mi>n</mi><mi>i</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X_1, X_2 \sim Unif (0, 1)</annotation></semantics></math>
independently, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mn>3</mn><mo>,</mo><msub><mi>β</mi><mn>2</mn></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\beta_0 = 1, \beta_1 = -3,
 \beta_2 = 3</annotation></semantics></math>. We observe
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Y=0</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Y</mi><mo>*</mo></msup><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Y^*&lt;0</annotation></semantics></math>.
These variables will be employed as inputs for Tobit regression analyses
provided by the <code>VGAM</code> and <code>AER</code> packages.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Tobit regression model</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.auckland.ac.nz/~yee/VGAM/" class="external-link">VGAM</a></span><span class="op">)</span></span>
<span><span class="va">beta13</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">beta14</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3</span></span>
<span><span class="va">beta15</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">x11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">x12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">lambda1</span> <span class="op">&lt;-</span> <span class="va">beta13</span> <span class="op">+</span> <span class="va">beta14</span> <span class="op">*</span> <span class="va">x11</span> <span class="op">+</span> <span class="va">beta15</span> <span class="op">*</span> <span class="va">x12</span></span>
<span><span class="va">sd0</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span><span class="va">yun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">lambda1</span>, sd <span class="op">=</span> <span class="va">sd0</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">yun</span> <span class="op">&gt;=</span> <span class="fl">0</span>, <span class="va">yun</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>The model <code>fit1miss</code>, corresponding to the right QQ plot,
intentionally omits the covariate x12. This omission leads to a
deviation from the diagonal line in the QQ plot, observed in the right
panel. Thus, it can be interpreted as the model misspecification. In
contrast, the left panel, corresponding to the model including all
covariates, aligns closely along the diagonal line.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using VGAM package</span></span>
<span><span class="co"># True model</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html" class="external-link">vglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x11</span> <span class="op">+</span> <span class="va">x12</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html" class="external-link">tobit</a></span><span class="op">(</span>Upper <span class="op">=</span> <span class="cn">Inf</span>, Lower <span class="op">=</span> <span class="fl">0</span>, lmu <span class="op">=</span> <span class="st">"identitylink"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Missing covariate</span></span>
<span><span class="va">fit1miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/vglm.html" class="external-link">vglm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x11</span>, <span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/tobit.html" class="external-link">tobit</a></span><span class="op">(</span>Upper <span class="op">=</span> <span class="cn">Inf</span>, Lower <span class="op">=</span> <span class="fl">0</span>, lmu <span class="op">=</span> <span class="st">"identitylink"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">resid1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resid_semiconti.html">resid_semiconti</a></span><span class="op">(</span><span class="va">fit1</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">resid2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resid_semiconti.html">resid_semiconti</a></span><span class="op">(</span><span class="va">fit1miss</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="semiconti_files/figure-html/tobit%20vgam2-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The interpretation remains the same as the <code>VGAM</code> example.
Note that the results from the <code>AER</code> are exactly the same as
those from the <code>VGAM</code> example.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using AER package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">AER</span><span class="op">)</span></span>
<span><span class="co"># True model</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AER/man/tobit.html" class="external-link">tobit</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x11</span> <span class="op">+</span> <span class="va">x12</span>, left <span class="op">=</span> <span class="fl">0</span>, right <span class="op">=</span> <span class="cn">Inf</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="co"># Missing covariate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit2miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AER/man/tobit.html" class="external-link">tobit</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x11</span>, left <span class="op">=</span> <span class="fl">0</span>, right <span class="op">=</span> <span class="cn">Inf</span>, dist <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">reisd1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resid_semiconti.html">resid_semiconti</a></span><span class="op">(</span><span class="va">fit2</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">resid2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resid_semiconti.html">resid_semiconti</a></span><span class="op">(</span><span class="va">fit2miss</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="semiconti_files/figure-html/tobit%20aer-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://luyang95.github.io" class="external-link">Lu Yang</a>, Jeonghwan Lee.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
