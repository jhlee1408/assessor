---
title: "Assessor: How to assess non-continuous outcome regression"
output: 
  rmarkdown::html_vignette:
  fig_caption: yes
  fig_width: 10
  fig_height: 10
vignette: >
  \VignetteIndexEntry{assesor}
  \VignetteEngine{knitr::knitr}
  \VignetteEncoding{UTF-8}{inputenc}
---

## Introduction
Assessor is a package that provides tools for assessing the assumptions of regression models with discrete, zero-inflated, and semi-continuous outcomes. Users can calculate the double probability integral transform (DPIT) residuals and draw QQ-plots via the DPIT residuals. 

## Installation
Like other R packages, `assessor` can be installed directly from CRAN.(I hope so.) Type the following command: 
```{r installation, eval=FALSE}
install.packages("assessor")
```

## General function arguments
In `assessor`, there are functions for assessing DPIT residuals for the various type of models: discrete, zero-inflated, and semi-continuous outcome regression models. `resid_disc()`, `resid_zeroinfl()`, `resid_semiconti()` and `resid_2pm()` are functions evaluating DPIT residuals. 
They share the same arguments:

* `model`: Each function supports different types of model objects. Check below which model objects are applicable.

* `plot`:If you set `plot=T`, a function will return QQ-plot drawn with DPIT residuals, or vice versa. 
Some users may only need the QQ-plot. In that case, `qqresdi()` only returns the QQ-plot without returning the DPIT residuals.

* `scale`: You can choose the scale of the residuals among `normal` and `uniform` scales. The sample quantiles of the residuals are plotted against the theoretical quantiles of a standard normal distribution under the normal scale, and against the theoretical quantiles of a uniform (0,1) distribution under the uniform scale. The default scale is `normal`



## `resid_disc()`
`resid_disc()` is used for calculating the DPIT residuals for regression models with discrete outcomes and drawing corresponding QQ-plots. The suitable model objects are as follows: 

* Poisson, `glm(formula, family=poisson(link="log"))` 
* Binary, `glm(, family=binomial(link="logit"))` 
* Negative Binomial, `MASS::glm.nb()` 
* Ordinal, `MASS::polr()` 


### Simulation for Negative binomial regression {.tabset}
An appropriate example of the usage of the `resid_disc()` function is in the context of Negative binomial regression. We can do this usting the code below. 

```{r discrete outcomes poi}
library(assessor)
library(MASS)
n=500
set.seed(1234)
## Negative Binomial example
# Covariates
x1<-rnorm(n); x2 <- rbinom(n,1,0.7)

### Parameters
beta0 <- -2; beta1 <- 2; beta2<- 1
size1<- 2
lambda1<-exp(beta0+beta1*x1+beta2*x2)

# generate outcomes
y <- rnbinom(n, mu=lambda1, size=size1)

# Models 
model1 <- glm.nb(y~x1+x2) # True model 
model2 <- glm(y~x1+x2,family = poisson(link = "log")) # Overdispersion
```

#### QQ-plots
```{r, fig.cap="Left panel: True model, Right Panel: Overdispersion", fig.width=8, fig.height=8}
# Residuals and QQ-plots
resid_true <- resid_disc(model1, plot = TRUE, scale="normal")
resid_overdisp <- resid_disc(model2, plot = TRUE, scale="normal")
```

We simulated 500 negative binomial data and fitted the two GLM. The former one is correct, the latter misspecified the link function. The resulting QQ-plots  

### Residuals
```{r}
head(resid_true)
```


### `resid_zeroinfl()`
`resid_zeroinfl()` is used for caclulating the DPIT residuals for regression models with zero-inflated discrete outcome. Applicable model objects are as follows:

*


```{r zeroinflated outcomes}

```

### `resid_semiconti()` {.tabset}
`resid_semiconti()` is used for assessing for regression models with semi-continuous outcomes. Particularly, the model object for a Tobit regression model derived by `VGAM` and `AER` packages and for a Tweedie regression derived by `tweedie` package is applicable. 

* Tweedie,`glm(formula,family = tweedie())`
* Tobit(VGAM), `vglm(formula, tobit(Upper = Inf, Lower = 0, lmu = "identitylink"))` 
* Tobit(AER), `tobit(formula,left = 0,right = Inf, dist = "gaussian")`

### `resid_2pm()`


```{r resid2_pm}
```


### `ord_curve()`
```{r }

```


