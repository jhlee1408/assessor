% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gof_disc.R
\name{gof_disc}
\alias{gof_disc}
\title{Goodness-of-fit test for discrete outcome regression models}
\usage{
gof_disc(model, B=1e2, seed=NULL)
}
\arguments{
\item{model}{A fitted model object (e.g., from \code{glm()}, \code{glm.nb()} or \code{zeroinfl()}).}

\item{B}{Number of bootstrap samples. Default is 1e2.}

\item{seed}{random seed for bootstrap.}
}
\value{
test statistics and p-values
}
\description{
Goodness-of-fit diagnostics for discrete-outcome regression models.
Works with GLMs (Poisson, binomial/logistic, negative binomial) and
zero-inflated regressions (Poisson and negative binomial via \code{pscl::zeroinfl()}).
}
\details{
This function implements the goodness-of-fit test for regression models
with discrete outcomes proposed by \cite{yang2025goodness}. Unlike classical
Pearson or deviance tests, it avoids randomization, tuning, or binning, and is
valid for models such as binomial, Poisson, negative binomial, and zeroinflated regression.
The test statistic
\deqn{S_n = \int_0^1 \{ \hat{H}(u) - u \}^2 du} measures deviation from the
identity function, with p-values obtained by bootstrap. This method
complements residual-based diagnostics by providing an inferential
check of model adequacy.
}
\examples{
library(MASS)
library(pscl)
n <- 500
B <- 1000
beta1 <- 1;  beta2 <- 1
beta0 <- -2; beta00 <- -2; beta10 <- 2
size1<- 2
set.seed(1)
x1 <- rnorm(n)
x2 <- rbinom(n,1,0.7)
lambda1 <- exp(beta0 + beta1 * x1 + beta2 * x2)
p0 <- 1 / (1 + exp(-(beta00 + beta10 * x1)))
y0 <- rbinom(n, size = 1, prob = 1 - p0)
y1 <- rnegbin(n, mu=lambda1, theta=size1)
y <- ifelse(y0 == 0, 0, y1)
model1 <- zeroinfl(y ~ x1 + x2 | x1, dist = "negbin", link = "logit")
gof_disc(model1)
}
\references{
Yang L, Genest C, Neslehova J (2025). “A goodness-of-fit test for regression models with discrete outcomes.” Canadian Journal of Statistics
}
